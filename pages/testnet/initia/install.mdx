import { Callout } from 'nextra/components'
import { Steps } from 'nextra/components'

## Setup Server

<Steps>

### Update Packages and Install Prerequisites

```js copy
sudo apt update && apt upgrade -y
sudo apt install curl git jq lz4 build-essential unzip fail2ban ufw -y
```

### Set Firewall

```js copy
sudo ufw default allow outgoing
sudo ufw default deny incoming
sudo ufw allow ssh
sudo ufw allow 9100
```

```js copy
sudo ufw enable
```

### Install GO

```js copy
ver="1.21.6"
wget "https://golang.org/dl/go$ver.linux-amd64.tar.gz"
sudo rm -rf /usr/local/go
sudo tar -C /usr/local -xzf "go$ver.linux-amd64.tar.gz"
rm "go$ver.linux-amd64.tar.gz"
echo "export PATH=$PATH:/usr/local/go/bin:$HOME/go/bin" >> $HOME/.bash_profile
source $HOME/.bash_profile
go version
```

### Node Installation

```js copy
cd $HOME
rm -rf wardenprotocol
git clone --depth 1 --branch v0.3.0 https://github.com/warden-protocol/wardenprotocol/
cd wardenprotocol
make install
```

### Set Configuration for your node
```js copy
wardend config chain-id buenavista-1
wardend config keyring-backend file
```

### Init your node

<Callout type="info" emoji="ℹ️">
  You can change "MyNode" to anything you like
</Callout>

```js copy
wardend init MyNode --chain-in buenavista-1
```

### Add Genesis File and Addrbook

```js copy
wget -O $HOME/.warden/config/genesis.json https://testnet-files.itrocket.net/warden/genesis.json
wget -O $HOME/.warden/config/addrbook.json https://testnet-files.itrocket.net/warden/addrbook.json
```
### Configure Seeds and Peers

```js copy
SEEDS="8288657cb2ba075f600911685670517d18f54f3b@warden-testnet-seed.itrocket.net:18656"
PEERS="b14f35c07c1b2e58c4a1c1727c89a5933739eeea@warden-testnet-peer.itrocket.net:18656,7e9adbd0a34fcab219c3a818a022248c575f622b@65.108.227.207:16656,dc0122e37c203dec43306430a1f1879650653479@37.27.97.16:26656,eee54c85c14748f7793738fadbc747ed1511efac@176.9.58.5:46656,8902e6a170e08225023a7fdd8b875c0349fef703@135.181.129.164:26656,d9989b8aea7c4ab2a8a8eedf3502dcb3a6bc2bbe@173.249.28.105:26656,54a99bd575cb708eb395cd6c04da902132c7c7c7@188.40.66.173:27356,59efdbcc845a1c8d299a71b7eb31b58de604778d@31.220.72.101:26656,b209b221edc3c8a61c50ad895f6852b08cf718f5@173.212.232.122:26656,7f6c095219b0ae2025b6ede827723477d467f0ee@109.199.123.151:46656,2f769486f886faafadcfee2d96a889728cf45a94@38.242.237.130:11256"
sed -i -e "s/^seeds *=.*/seeds = \"$SEEDS\"/; s/^persistent_peers *=.*/persistent_peers = \"$PEERS\"/" $HOME/.warden/config/config.toml
```

### Set Pruning, Enable Prometheus, Gas Prices, and Indexer

```js copy
PRUNING="custom"
PRUNING_KEEP_RECENT="100"
PRUNING_INTERVAL="19"

sed -i -e "s/^pruning *=.*/pruning = "$PRUNING"/" $HOME/.warden/config/app.toml
sed -i -e "s/^pruning-keep-recent *=.*/pruning-keep-recent = "$PRUNING_KEEP_RECENT"/" $HOME/.warden/config/app.toml
sed -i -e "s/^pruning-interval *=.*/pruning-interval = "$PRUNING_INTERVAL"/" $HOME/.warden/config/app.toml
sed -i 's|^prometheus *=.*|prometheus = true|' $HOME/.warden/config/config.toml
```

###  Set Service file

```js copy
sudo tee /etc/systemd/system/wardend.service > /dev/null <<EOF
[Unit]
Description=Warden node
After=network-online.target
[Service]
User=$USER
ExecStart=$(which wardend) start
Restart=always
RestartSec=3
LimitNOFILE=65535
[Install]
WantedBy=multi-user.target
EOF
sudo systemctl daemon-reload
sudo systemctl enable wardend
```
### Download Latest Snapshot

```js copy
wardend tendermint unsafe-reset-all --home $HOME/.warden
if curl -s --head curl https://testnet-files.itrocket.net/warden/snap_warden.tar.lz4 | head -n 1 | grep "200" > /dev/null; then
  curl https://testnet-files.itrocket.net/warden/snap_warden.tar.lz4 | lz4 -dc - | tar -xf - -C $HOME/.warden
    else
  echo no have snap
fi
```

### Start the Node

```js copy
sudo systemctl restart wardend
sudo journalctl -fu wardend -o cat
```
</Steps>

